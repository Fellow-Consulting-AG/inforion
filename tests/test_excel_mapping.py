# Import the code to be tested

import pytest
import unittest
from _pytest._io.saferepr import saferepr
import logging
import os

from inforion.excelexport import *

valid_outputfilename = "Test.xlsx"
valid_program = "CRS610MI"

#api_endpoints = ['CMBR02MI','OIS005MI','OIS320MI','PPS001MI','MWS410MI','MOS450MI','ENS100MI','MMS240MI','MHS200MI','OSS450MI','CRS434MI','GLS180MI','COS406MI','QUS160MI','SES450MI','CUSEXTMI','CRS014MI','EVS002MI','QMS013MI','MNS204MI','CRS910MI','SOS001MI','ARBR75MI','PDS029MI','OPS660MI','CRS395MI','OIBR04MI','CRS137MI','QMS302MI','PDS022MI','CRS044MI','QMS011MI','PCS005MI','PDS010MI','PMS100MI','DRS029MI','SES405MI','CMS030MI','CRS798MI','MOS104MI','RPS300MI','OSS402MI','LTS200MI','ATS061MI','APBR53MI','MHS800MI','SAS100MI','CRS007MI','RPS200MI','COS119MI','MWS330MI','MHS002MI','CMS220MI','MNS415MI','CMS095MI','PPS100MI','SOS400MI','MHS640MI','SAS018MI','CRS886MI','OPS270MI','PPS360MI','MMS252MI','QMS014MI','CRS621MI','FCS330MI','CMS950MI','CTS040MI','POS100MI','AHS100MI','QUS114MI','DRS500MI','CMS020MI','DRS013MI','PPS112MI','LISTMI','ECS200MI','MMS100MI','MOS050MI','OIS120MI','CMS535MI','QMS450MI','MOS297MI','MNS218MI','ATS040MI','APBR50MI','CMS616MI','CRS990MI','RPS195MI','PPS040MI','QMS006MI','MNS405MI','MMS307MI','PMS120MI','PDS250MI','CRS750MI','MOS256MI','QUS116MI','MOS171MI','POS291MI','APS455MI','FAS002MI','CMS236MI','CBS006MI','CRS396MI','DRS021MI','CRRU20MI','CSS204MI','MNS155MI','CLAIMSMI','OIS407MI','OIS422MI','MHS020MI','MMS009MI','CMS137MI','DRS016MI','TXS011MI','QMS002MI','MWS121MI','OIS421MI','OIS336MI','CMS096MI','APS390MI','MOS306MI','CMS530MI','CSS300MI','MMS162MI','CRS165MI','MMS850MI','CRS316MI','MMS059MI','FAS845MI','STS201MI','PCS115MI','CRRU01MI','PDS028MI','FCS366MI','OIS340MI','CMS130MI','GLS250MI','CMS432MI','CMS471MI','FAS955MI','OIS860MI','TXS910MI','MMS022MI','MFS301MI','PDS007MI','DPS910MI','GLS016MI','CRS096MI','CBS011MI','CRS388MI','APS250MI','PMS170MI','SHS010MI','OIS210MI','STS106MI','MOS102MI','QMS015MI','QMS007MI','MWS440MI','STS117MI','XBR001MI','CSS105MI','OIS155MI','RPS070MI','ATS014MI','RPS180MI','PPS280MI','CMS012MI','CRS222MI','MWS422MI','ATS200MI','AHS110MI','QQS001MI','MMS310MI','ABS181MI','REFFLDMI','MWS150MI','QMS200MI','BODCSSMI','CRS063MI','APAT13MI','CMS880MI','DRS045MI','MNGDIMMI','MNS260MI','SOS100MI','MWS460MI','MMS008MI','SOS811MI','CMS235MI','MNS051MI','MNS205MI','CRS035MI','SOS800MI','CRIT10MI','CMS430MI','CMS965MI','MMS018MI','QMS100MI','CMS300MI','TXS140MI','COS429MI','OIS350MI','CRS200MI','OIS275MI','MOS170MI','PMS230MI','CMS082MI','PDS042MI','CRS949MI','CRS070MI','ECS420MI','SES410MI','CCHKVOMI','POS481MI','CRS683MI','PDS056MI','LTS100MI','MMS122MI','PDS017MI','STS940MI','MOS070MI','RPS170MI','CRS950MI','POS480MI','MNS215MI','APS440MI','COS403MI','CMS105MI','CMS081MI','OPS600MI','MMS025MI','DPS170MI','MFS303MI','MNS206MI','SOS300MI','CSS720MI','CMS135MI','CRS008MI','QQS005MI','APBR51MI','PPS500MI','OPS200MI','ATS030MI','MOS105MI','CMS615MI','MWS072MI','CMS045MI','OIS125MI','OIS175MI','CRS645MI','CMS350MI','CRS055MI','CMS071MI','MFS610MI','STS100MI','CMS072MI','STS107MI','PPS330MI','OIS439MI','POS061MI','MOS250MI','MMS028MI','AGS140MI','MMS450MI','MOS127MI','MMS076MI','CRS900MI','CMS048MI','OIS847MI','CBS007MI','CMS018MI','PMS420MI','QMS012MI','CEVENTMI','MWS420MI','APS450MI','MMS250MI','SES400MI','MMS016MI','MHS805MI','MMS472MI','FACETMI','MWS423MI','MMS105MI','CSS200MI','MMS021MI','ARBR01MI','CRS036MI','CRS690MI','MFS025MI','OIS431MI','MMS465MI','QUS020MI','QMS010MI','COS421MI','CRSPCIMI','OIS215MI','MMS080MI','PPS008MI','MMS005MI','SOS550MI','PDS090MI','GLS032MI','COS180MI','CRRU21MI','MNS425MI','ECS018MI','SES411MI','CMBR01MI','MMS235MI','CMS035MI','OIS325MI','MWS091MI','PDS003MI','SAS110MI','CRS995MI','CRS530MI','CRS515MI','PPS320MI','PPS370MI','MWSLWMMI','CSS006MI','RPS040MI','TMS006MI','MMS037MI','CRRU02MI','APCH01MI','ATS050MI','CRRU03MI','CRS100MI','MMS241MI','STS030MI','QUS115MI','CTS095MI','STS205MI','COS150MI','CRS247MI','CRS061MI','MMS160MI','QMS400MI','MFS300MI','PDS600MI','MHS001MI','MNS150MI','CRRU05MI','RSS110MI','CRS080MI','FAS004MI','CRS693MI','MFS302MI','CMS460MI','FLS001MI','APBR30MI','AUTCHKMI','MMS010MI','MOS057MI','SES300MI','FAS841MI','MMS476MI','POS350MI','DRS011MI','MOS440MI','CMS975MI','RMS440MI','INVBODMI','CSS100MI','POS110MI','PDS041MI','FAS840MI','SES440MI','APS430MI','CRS682MI','POS063MI','PMS260MI','MWS090MI','PPS205MI','CBS012MI','STS120MI','CMS525MI','CMS212MI','OIS031MI','OIS412MI','MMS175MI','CMS200MI','POS211MI','CRS275MI','SOS600MI','MHS854MI','MWS429MI','PMS018MI','EVS001MI','CMS103MI','MFS620MI','MOS446MI','CBS010MI','MOS054MI','APS201MI','OIS010MI','MRS001MI','MWS020MI','OIBR05MI','MOS290MI','TXS035MI','CRS022MI','FCS350MI','COS024MI','OIS850MI','PPS135MI','EVS010MI','CRS183MI','PMS055MI','CRS691MI','PDS001MI','MMS301MI','QMS009MI','MOS200MI','APS251MI','MHS005MI','CSSEITMI','MMS050MI','QQS011MI','QUS050MI','PPS099MI','OIS335MI','DRS020MI','CRS913MI','OIS560MI','PPS010MI','OIS358MI','RPS120MI','ABS180MI','STS125MI','CMS015MI','SAS120MI','POS410MI','CRS212MI','AHS200MI','ATS101MI','TXS072MI','CRS122MI','ATS020MI','CUGEXTMI','TEMPLATEMI','COS433MI','DRS015MI','CMS540MI','COS275MI','CRRU06MI','ARS450MI','PDS050MI','ABS182MI','MDBREADMI','CMS700MI','QUS113MI','MTS300MI','OIS028MI','STS140MI','CMS083MI','TXS905MI','COS470MI','CMS076MI','OIS060MI','PPS095MI','GTCN10MI','CMS086MI','QMS001MI','CRS399MI','STS110MI','OIS438MI','CRS633MI','AAS390MI','MNTAGRMI','STS017MI','CMS009MI','BOOKMKMI','QMS500MI','MHS635MI','DRS150MI','CRS881MI','MNS100MI','PDS605MI','CRS438MI','PDS071MI','MYS500MI','DRS151MI','MWS025MI','GLS215MI','TXS070MI','QMS008MI','MMS259MI','CRS230MI','SES120MI','PMS085MI','MOS085MI','RPS185MI','MHS630MI','CRS041MI','CAS310MI','APS110MI','CRS169MI','STS060MI','CBS001MI','TXS130MI','APS190MI','TXS300MI','MWS070MI','CRS105MI','PDS075MI','TXS095MI','MNS416MI','MNS410MI','OIS820MI','STS109MI','MMS120MI','CMS085MI','OIS030MI','MWS080MI','DPS001MI','PCS120MI','CRS042MI','CRS180MI','OIS038MI','QUS119MI','MMS006MI','FAS003MI','MMS470MI','OSBSTDMI','OIS052MI','AAS910MI','CRS060MI','MHS850MI','CRS692MI','CMS470MI','OIS840MI','OIS326MI','OPS210MI','PPS195MI','TXIT40MI','CMS011MI','MOS100MI','OIS022MI','PDS360MI','MOS770MI','PMS070MI','MWS073MI','MOS510MI','COS100MI','OSS401MI','AAS320MI','STS675MI','ATS010MI','ABS960MI','CRS618MI','MWS495MI','SES490MI','CRS004MI','COS413MI','CMS007MI','STS350MI','GMS200MI','CMS472MI','MWS023MI','PCS495MI','PPS160MI','QPS115MI','AAS333MI','QMS300MI','CRS006MI','CRS052MI','SES403MI','GLS840MI','EUS001MI','PMS090MI','PPS194MI','SOS200MI','CRS300MI','MHS003MI','ARS251MI','MNS036MI','AGS101MI','OIS390MI','MNS096MI','OIS035MI','CRS185MI','MOS272MI','CMS461MI','OIS017MI','CRS050MI','CRS181MI','CRS207MI','CRS945MI','QMS301MI','MOS125MI','OIS006MI','PDS023MI','PPS310MI','SES510MI','QUS118MI','OIS440MI','CBS005MI','STS040MI','APS051MI','MOS260MI','OIS100MI','STS101MI','XFI100MI','MMS130MI','CRS235MI','DRS005MI','OSS420MI','PPS108MI','PPS007MI','MOS180MI','SES415MI','OPS500MI','ARS015MI','MNS420MI','MNS105MI','PPS042MI','CRS046MI','MMS060MI','CRS628MI','COS410MI','OIS015MI','PDS055MI','MHS025MI','PDS057MI','SOS350MI','MMS090MI','COS160MI','CBS003MI','APS026MI','MNS216MI','CRS420MI','CMS001MI','DRS007MI','ECS300MI','CRS045MI','OIS012MI','QUS046MI','PPS364MI','CMS473MI','SOS050MI','MOS140MI','POS176MI','ARS200MI','AEMAPIMI','PMS155MI','APS025MI','OIS165MI','CRCCINMI','MWS120MI','CRS650MI','SPS020MI','CRS109MI','CRS065MI','CRS184MI','MMS230MI','CMS005MI','CRS335MI','CMS210MI','PPS285MI','PDS043MI','COS350MI','DRS006MI','MMS092MI','PPS200MI','MWS417MI','QUS100MI','CRS620MI','MMS040MI','MOS382MI','STS455MI','PPS386MI','CPS170MI','CMS080MI','MMS015MI','MOS595MI','QUS060MI','COS117MI','APS200MI','DRS100MI','CAS393MI','CMS100MI','CRS295MI','MHS810MI','PDS044MI','MNS217MI','ECS001MI','OSS406MI','RPS675MI','CMS075MI','QMS210MI','MHS820MI','COS605MI','STS118MI','CRS099MI','COS170MI','MMS095MI','MOS120MI','MMS460MI','OIS530MI','TXS091MI','ABS965MI','ARS460MI','CMS025MI','CMS055MI','PMS050MI','SOS500MI','CRS064MI','MOS018MI','CMS010MI','OIS800MI','MHS221MI','ABS100MI','MOS124MI','STS122MI','TXS071MI','MNS035MI','PPS197MI','PPS385MI','MWS081MI','CMS050MI','LTS101MI','CMS008MI','BROWSEMI','POS111MI','MNS910MI','DRS018MI','TXS090MI','AAS640MI','CRS111MI','RPS080MI','CRTVSUMI','MMS074MI','CRS030MI','RPS680MI','PMS270MI','ABS185MI','ARS300MI','OIS430MI','CRS140MI','CRS220MI','CMS133MI','DRS102MI','MOS095MI','QMS003MI','OIS111MI','MYS450MI','CRS020MI','MMS023MI','PDS030MI','MLS170MI','MNS111MI','LTS108MI','OIS337MI','APS130MI','BUS100MI','MOS049MI','MOS500MI','OIS345MI','SOS408MI','PPS106MI','GENERAL','MOS380MI','SPS100MI','MMS072MI','GLS015MI','MMS017MI','CRS051MI','RPS090MI','QMS005MI','STS105MI','ECS003MI','APS050MI','CBS002MI','CMS003MI','CRS912MI','MMS053MI','PMS080MI','CRS114MI','PPS235MI','PPS170MI','TXS040MI','CRS075MI','MOS195MI','MMS004MI','MMS057MI','OIS867MI','CRS980MI','MOS300MI','STS465MI','QMS201MI','MOS461MI','QMS290MI','GLS030MI','STS046MI','CRS121MI','CRS630MI','CMS131MI','STS103MI','ARS040MI','EXPORTMI','CRS138MI','COS115MI','PDS040MI','OIBR03MI','MNS120MI','QUS095MI','CMS474MI','STS124MI','AAS330MI','ECS422MI','MMS019MI','MOS160MI','MMS030MI','APS015MI','CRS290MI','SOS805MI','CMS970MI','PDS008MI','CMS004MI','OIS415MI','LTS350MI','EQINFOMI','POS210MI','CRS221MI','MOS390MI','AGS100MI','ARS120MI','OIS865MI','CSSEIXMI','MOS296MI','QMS501MI','PMS060MI','TXAT30MI','CRS612MI','MNS095MI','OPS650MI','TMS800MI','AGS130MI','ARS201MI','QMS150MI','GLS200MI','CRS078MI','TXS100MI','CRS646MI','CRS278MI','PPSSPPMI','MWS411MI','OIS004MI','MOS400MI','PDS016MI','PDS002MI','OIS436MI','MMS200MI','AAS350MI','MHS040MI','MMS124MI','QUS117MI','POS062MI','MMS300MI','CMS006MI','MNS030MI','COS435MI','CRS175MI','CRS610MI','STS456MI','STS123MI','RPS045MI','CRS830MI','SPS101MI','MHS220MI','OIS370MI','PMS150MI','MOS820MI','PMS130MI','FAS010MI','PPS018MI','PPS136MI','CRS025MI','MOS087MI','MMS020MI','TXS003MI','CRRU04MI','CRS128MI','FAS001MI','PPS390MI','APS106MI','CBS004MI','MHS015MI','MOS156MI','QMS004MI','OIS105MI','MWS001MI','CRIT24MI','PPSEPRMI']
api_endpoints_valid = ['CMBR02MI','OIS005MI','OIS320MI','PPS001MI','MWS410MI','MOS450MI','ENS100MI','MMS240MI','MHS200MI']
api_endpoints_invalid = ['CMBR02CC']

def test_param1_missing():
    assert  "Error: Program name is missing" in generate_api_template_file(None,valid_outputfilename)

def test_param2_missing():
    assert  "Error: Output filename is missing" in generate_api_template_file(valid_program,None)

def test_api_file_exists():
    # Check if api files exist for valid endpoints
    for endpoint in api_endpoints_valid:
        assert getAPIFile(endpoint)

    # Check if we get none for invalid endpoints
    for endpoint in api_endpoints_invalid:
        assert not getAPIFile(endpoint)

def test_template_file_exists():
    assert checkIfTemplateFileExists() is True

def test_can_create_new_template_file():
    assert createEmptySheet(valid_outputfilename, False) is True
